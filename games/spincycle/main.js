/* Zepto v1.0rc1 - polyfill zepto event detect fx ajax form touch - zeptojs.com/license */

/**
 * @license
 * Lo-Dash 1.3.1 (Custom Build) lodash.com/license
 * Build: `lodash underscore exports="amd,commonjs,global,node" -o ./dist/lodash.underscore.js`
 * Underscore.js 1.4.4 underscorejs.org/LICENSE
 */

//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

(function(e){String.prototype.trim===e&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===e&&(Array.prototype.reduce=function(t){if(this===void 0||this===null)throw new TypeError;var n=Object(this),r=n.length>>>0,i=0,s;if(typeof t!="function")throw new TypeError;if(r==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)s=arguments[1];else do{if(i in n){s=n[i++];break}if(++i>=r)throw new TypeError}while(!0);while(i<r)i in n&&(s=t.call(e,s,n[i],i,n)),i++;return s})})();var Zepto=function(){function C(e){return E.call(e)=="[object Function]"}function k(e){return e instanceof Object}function L(t){var n,r;if(E.call(t)!=="[object Object]")return!1;r=C(t.constructor)&&t.constructor.prototype;if(!r||!hasOwnProperty.call(r,"isPrototypeOf"))return!1;for(n in t);return n===e||hasOwnProperty.call(t,n)}function A(e){return e instanceof Array}function O(e){return typeof e.length=="number"}function M(t){return t.filter(function(t){return t!==e&&t!==null})}function _(e){return e.length>0?[].concat.apply([],e):e}function D(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function P(e){return e in a?a[e]:a[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function H(e,t){return typeof t=="number"&&!l[D(e)]?t+"px":t}function B(e){var t,n;return u[e]||(t=o.createElement(e),o.body.appendChild(t),n=f(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),n=="none"&&(n="block"),u[e]=n),u[e]}function j(t,r){return r===e?n(t):n(t).filter(r)}function F(e,t,n,r){return C(t)?t.call(e,n,r):t}function I(e,t,r){var i=e%2?t:t.parentNode;i?i.insertBefore(r,e?e==1?i.firstChild:e==2?t:null:t.nextSibling):n(r).remove()}function q(e,t){t(e);for(var n in e.childNodes)q(e.childNodes[n],t)}var e,t,n,r,i=[],s=i.slice,o=window.document,u={},a={},f=o.defaultView.getComputedStyle,l={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},c=/^\s*<(\w+|!)[^>]*>/,h=[1,3,8,9,11],p=["after","prepend","before","append"],d=o.createElement("table"),v=o.createElement("tr"),m={tr:o.createElement("tbody"),tbody:d,thead:d,tfoot:d,td:v,th:v,"*":o.createElement("div")},g=/complete|loaded|interactive/,y=/^\.([\w-]+)$/,b=/^#([\w-]+)$/,w=/^[\w-]+$/,E={}.toString,S={},x,T,N=o.createElement("div");return S.matches=function(e,t){if(!e||e.nodeType!==1)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r,i=e.parentNode,s=!i;return s&&(i=N).appendChild(e),r=~S.qsa(i,t).indexOf(e),s&&N.removeChild(e),r},x=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},T=function(e){return e.filter(function(t,n){return e.indexOf(t)==n})},S.fragment=function(t,r){r===e&&(r=c.test(t)&&RegExp.$1),r in m||(r="*");var i=m[r];return i.innerHTML=""+t,n.each(s.call(i.childNodes),function(){i.removeChild(this)})},S.Z=function(e,t){return e=e||[],e.__proto__=arguments.callee.prototype,e.selector=t||"",e},S.isZ=function(e){return e instanceof S.Z},S.init=function(t,r){if(!t)return S.Z();if(C(t))return n(o).ready(t);if(S.isZ(t))return t;var i;if(A(t))i=M(t);else if(L(t))i=[n.extend({},t)],t=null;else if(h.indexOf(t.nodeType)>=0||t===window)i=[t],t=null;else if(c.test(t))i=S.fragment(t.trim(),RegExp.$1),t=null;else{if(r!==e)return n(r).find(t);i=S.qsa(o,t)}return S.Z(i,t)},n=function(e,t){return S.init(e,t)},n.extend=function(n){return s.call(arguments,1).forEach(function(r){for(t in r)r[t]!==e&&(n[t]=r[t])}),n},S.qsa=function(e,t){var n;return e===o&&b.test(t)?(n=e.getElementById(RegExp.$1))?[n]:i:e.nodeType!==1&&e.nodeType!==9?i:s.call(y.test(t)?e.getElementsByClassName(RegExp.$1):w.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t))},n.isFunction=C,n.isObject=k,n.isArray=A,n.isPlainObject=L,n.inArray=function(e,t,n){return i.indexOf.call(t,e,n)},n.trim=function(e){return e.trim()},n.uuid=0,n.map=function(e,t){var n,r=[],i,s;if(O(e))for(i=0;i<e.length;i++)n=t(e[i],i),n!=null&&r.push(n);else for(s in e)n=t(e[s],s),n!=null&&r.push(n);return _(r)},n.each=function(e,t){var n,r;if(O(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(r in e)if(t.call(e[r],r,e[r])===!1)return e;return e},n.fn={forEach:i.forEach,reduce:i.reduce,push:i.push,indexOf:i.indexOf,concat:i.concat,map:function(e){return n.map(this,function(t,n){return e.call(t,n,t)})},slice:function(){return n(s.apply(this,arguments))},ready:function(e){return g.test(o.readyState)?e(n):o.addEventListener("DOMContentLoaded",function(){e(n)},!1),this},get:function(t){return t===e?s.call(this):this[t]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(e){return this.forEach(function(t,n){e.call(t,n,t)}),this},filter:function(e){return n([].filter.call(this,function(t){return S.matches(t,e)}))},add:function(e,t){return n(T(this.concat(n(e,t))))},is:function(e){return this.length>0&&S.matches(this[0],e)},not:function(t){var r=[];if(C(t)&&t.call!==e)this.each(function(e){t.call(this,e)||r.push(this)});else{var i=typeof t=="string"?this.filter(t):O(t)&&C(t.item)?s.call(t):n(t);this.forEach(function(e){i.indexOf(e)<0&&r.push(e)})}return n(r)},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!k(e)?e:n(e)},last:function(){var e=this[this.length-1];return e&&!k(e)?e:n(e)},find:function(e){var t;return this.length==1?t=S.qsa(this[0],e):t=this.map(function(){return S.qsa(this,e)}),n(t)},closest:function(e,t){var r=this[0];while(r&&!S.matches(r,e))r=r!==t&&r!==o&&r.parentNode;return n(r)},parents:function(e){var t=[],r=this;while(r.length>0)r=n.map(r,function(e){if((e=e.parentNode)&&e!==o&&t.indexOf(e)<0)return t.push(e),e});return j(t,e)},parent:function(e){return j(T(this.pluck("parentNode")),e)},children:function(e){return j(this.map(function(){return s.call(this.children)}),e)},siblings:function(e){return j(this.map(function(e,t){return s.call(t.parentNode.children).filter(function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return this.map(function(){return this[e]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),f(this,"").getPropertyValue("display")=="none"&&(this.style.display=B(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return this.each(function(){n(this).wrapAll(n(e)[0].cloneNode(!1))})},wrapAll:function(e){return this[0]&&(n(this[0]).before(e=n(e)),e.append(this)),this},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},clone:function(){return n(this.map(function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(t){return(t===e?this.css("display")=="none":t)?this.show():this.hide()},prev:function(){return n(this.pluck("previousElementSibling"))},next:function(){return n(this.pluck("nextElementSibling"))},html:function(t){return t===e?this.length>0?this[0].innerHTML:null:this.each(function(e){var r=this.innerHTML;n(this).empty().append(F(this,t,e,r))})},text:function(t){return t===e?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t})},attr:function(n,r){var i;return typeof n=="string"&&r===e?this.length==0||this[0].nodeType!==1?e:n=="value"&&this[0].nodeName=="INPUT"?this.val():!(i=this[0].getAttribute(n))&&n in this[0]?this[0][n]:i:this.each(function(e){if(this.nodeType!==1)return;if(k(n))for(t in n)this.setAttribute(t,n[t]);else this.setAttribute(n,F(this,r,e,this.getAttribute(n)))})},removeAttr:function(e){return this.each(function(){this.nodeType===1&&this.removeAttribute(e)})},prop:function(t,n){return n===e?this[0]?this[0][t]:e:this.each(function(e){this[t]=F(this,n,e,this[t])})},data:function(t,n){var r=this.attr("data-"+D(t),n);return r!==null?r:e},val:function(t){return t===e?this.length>0?this[0].value:e:this.each(function(e){this.value=F(this,t,e,this.value)})},offset:function(){if(this.length==0)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:e.width,height:e.height}},css:function(n,r){if(r===e&&typeof n=="string")return this.length==0?e:this[0].style[x(n)]||f(this[0],"").getPropertyValue(n);var i="";for(t in n)typeof n[t]=="string"&&n[t]==""?this.each(function(){this.style.removeProperty(D(t))}):i+=D(t)+":"+H(t,n[t])+";";return typeof n=="string"&&(r==""?this.each(function(){this.style.removeProperty(D(n))}):i=D(n)+":"+H(n,r)),this.each(function(){this.style.cssText+=";"+i})},index:function(e){return e?this.indexOf(n(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return this.length<1?!1:P(e).test(this[0].className)},addClass:function(e){return this.each(function(t){r=[];var i=this.className,s=F(this,e,t,i);s.split(/\s+/g).forEach(function(e){n(this).hasClass(e)||r.push(e)},this),r.length&&(this.className+=(i?" ":"")+r.join(" "))})},removeClass:function(t){return this.each(function(n){if(t===e)return this.className="";r=this.className,F(this,t,n,r).split(/\s+/g).forEach(function(e){r=r.replace(P(e)," ")}),this.className=r.trim()})},toggleClass:function(t,r){return this.each(function(i){var s=F(this,t,i,this.className);(r===e?!n(this).hasClass(s):r)?n(this).addClass(s):n(this).removeClass(s)})}},["width","height"].forEach(function(t){n.fn[t]=function(r){var i,s=t.replace(/./,function(e){return e[0].toUpperCase()});return r===e?this[0]==window?window["inner"+s]:this[0]==o?o.documentElement["offset"+s]:(i=this.offset())&&i[t]:this.each(function(e){var i=n(this);i.css(t,F(this,r,e,i[t]()))})}}),p.forEach(function(e,t){n.fn[e]=function(){var e=n.map(arguments,function(e){return k(e)?e:S.fragment(e)});if(e.length<1)return this;var r=this.length,i=r>1,s=t<2;return this.each(function(n,o){for(var u=0;u<e.length;u++){var a=e[s?e.length-u-1:u];q(a,function(e){e.nodeName!=null&&e.nodeName.toUpperCase()==="SCRIPT"&&(!e.type||e.type==="text/javascript")&&window.eval.call(window,e.innerHTML)}),i&&n<r-1&&(a=a.cloneNode(!0)),I(t,o,a)}})},n.fn[t%2?e+"To":"insert"+(t?"Before":"After")]=function(t){return n(t)[e](this),this}}),S.Z.prototype=n.fn,S.camelize=x,S.uniq=T,n.zepto=S,n}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(e){function s(e){return e._zid||(e._zid=r++)}function o(e,t,r,i){t=u(t);if(t.ns)var o=a(t.ns);return(n[s(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||o.test(e.ns))&&(!r||s(e.fn)===s(r))&&(!i||e.sel==i)})}function u(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function a(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function f(t,n,r){e.isObject(t)?e.each(t,r):t.split(/\s/).forEach(function(e){r(e,n)})}function l(t,r,i,o,a,l){l=!!l;var c=s(t),h=n[c]||(n[c]=[]);f(r,i,function(n,r){var i=a&&a(r,n),s=i||r,f=function(e){var n=s.apply(t,[e].concat(e.data));return n===!1&&e.preventDefault(),n},c=e.extend(u(n),{fn:r,proxy:f,sel:o,del:i,i:h.length});h.push(c),t.addEventListener(c.e,f,l)})}function c(e,t,r,i){var u=s(e);f(t||"",r,function(t,r){o(e,t,r,i).forEach(function(t){delete n[u][t.i],e.removeEventListener(t.e,t.proxy,!1)})})}function v(t){var n=e.extend({originalEvent:t},t);return e.each(d,function(e,r){n[e]=function(){return this[r]=h,t[e].apply(t,arguments)},n[r]=p}),n}function m(e){if(!("defaultPrevented"in e)){e.defaultPrevented=!1;var t=e.preventDefault;e.preventDefault=function(){this.defaultPrevented=!0,t.call(this)}}}var t=e.zepto.qsa,n={},r=1,i={};i.click=i.mousedown=i.mouseup=i.mousemove="MouseEvents",e.event={add:l,remove:c},e.proxy=function(t,n){if(e.isFunction(t)){var r=function(){return t.apply(n,arguments)};return r._zid=s(t),r}if(typeof n=="string")return e.proxy(t[n],t);throw new TypeError("expected function")},e.fn.bind=function(e,t){return this.each(function(){l(this,e,t)})},e.fn.unbind=function(e,t){return this.each(function(){c(this,e,t)})},e.fn.one=function(e,t){return this.each(function(n,r){l(this,e,t,null,function(e,t){return function(){var n=e.apply(r,arguments);return c(r,t,e),n}})})};var h=function(){return!0},p=function(){return!1},d={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,n,r){var i=!1;if(n=="blur"||n=="focus")e.iswebkit?n=n=="blur"?"focusout":n=="focus"?"focusin":n:i=!0;return this.each(function(s,o){l(o,n,r,t,function(n){return function(r){var i,s=e(r.target).closest(t,o).get(0);if(s)return i=e.extend(v(r),{currentTarget:s,liveFired:o}),n.apply(s,[i].concat([].slice.call(arguments,1)))}},i)})},e.fn.undelegate=function(e,t,n){return this.each(function(){c(this,t,n,e)})},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,r){return n==undefined||e.isFunction(n)?this.bind(t,n):this.delegate(n,t,r)},e.fn.off=function(t,n,r){return n==undefined||e.isFunction(n)?this.unbind(t,n):this.undelegate(n,t,r)},e.fn.trigger=function(t,n){return typeof t=="string"&&(t=e.Event(t)),m(t),t.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(t)})},e.fn.triggerHandler=function(t,n){var r,i;return this.each(function(s,u){r=v(typeof t=="string"?e.Event(t):t),r.data=n,r.target=u,e.each(o(u,t.type||t),function(e,t){i=t.proxy(r);if(r.isImmediatePropagationStopped())return!1})}),i},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){if(e)this.bind(t,e);else if(this.length)try{this.get(0)[t]()}catch(n){}return this}}),e.Event=function(e,t){var n=document.createEvent(i[e]||"Events"),r=!0;if(t)for(var s in t)s=="bubbles"?r=!!t[s]:n[s]=t[s];return n.initEvent(e,r,!0,null,null,null,null,null,null,null,null,null,null,null,null),n}}(Zepto),function(e){function t(e){var t=this.os={},n=this.browser={},r=e.match(/WebKit\/([\d.]+)/),i=e.match(/(Android)\s+([\d.]+)/),s=e.match(/(iPad).*OS\s([\d_]+)/),o=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),a=u&&e.match(/TouchPad/),f=e.match(/Kindle\/([\d.]+)/),l=e.match(/Silk\/([\d._]+)/),c=e.match(/(BlackBerry).*Version\/([\d.]+)/);if(n.webkit=!!r)n.version=r[1];i&&(t.android=!0,t.version=i[2]),o&&(t.ios=t.iphone=!0,t.version=o[2].replace(/_/g,".")),s&&(t.ios=t.ipad=!0,t.version=s[2].replace(/_/g,".")),u&&(t.webos=!0,t.version=u[2]),a&&(t.touchpad=!0),c&&(t.blackberry=!0,t.version=c[2]),f&&(t.kindle=!0,t.version=f[1]),l&&(n.silk=!0,n.version=l[1]),!l&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0)}t.call(e,navigator.userAgent),e.__detect=t}(Zepto),function(e,t){function c(e){return e.toLowerCase()}function h(e){return r?r+e:c(e)}var n="",r,i,s,o={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},u=window.document,a=u.createElement("div"),f=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,l={};e.each(o,function(e,i){if(a.style[e+"TransitionProperty"]!==t)return n="-"+c(e)+"-",r=i,!1}),l[n+"transition-property"]=l[n+"transition-duration"]=l[n+"transition-timing-function"]=l[n+"animation-name"]=l[n+"animation-duration"]="",e.fx={off:r===t&&a.style.transitionProperty===t,cssPrefix:n,transitionEnd:h("TransitionEnd"),animationEnd:h("AnimationEnd")},e.fn.animate=function(t,n,r,i){return e.isObject(n)&&(r=n.easing,i=n.complete,n=n.duration),n&&(n/=1e3),this.anim(t,n,r,i)},e.fn.anim=function(r,i,s,o){var u,a={},c,h=this,p,d=e.fx.transitionEnd;i===t&&(i=.4),e.fx.off&&(i=0);if(typeof r=="string")a[n+"animation-name"]=r,a[n+"animation-duration"]=i+"s",d=e.fx.animationEnd;else{for(c in r)f.test(c)?(u||(u=[]),u.push(c+"("+r[c]+")")):a[c]=r[c];u&&(a[n+"transform"]=u.join(" ")),!e.fx.off&&typeof r=="object"&&(a[n+"transition-property"]=Object.keys(r).join(", "),a[n+"transition-duration"]=i+"s",a[n+"transition-timing-function"]=s||"linear")}return p=function(t){if(typeof t!="undefined"){if(t.target!==t.currentTarget)return;e(t.target).unbind(d,arguments.callee)}e(this).css(l),o&&o.call(this)},i>0&&this.bind(d,p),setTimeout(function(){h.css(a),i<=0&&setTimeout(function(){h.each(function(){p.call(this)})},0)},0),this},a=null}(Zepto),function($){function triggerAndReturn(e,t,n){var r=$.Event(t);return $(e).trigger(r,n),!r.defaultPrevented}function triggerGlobal(e,t,n,r){if(e.global)return triggerAndReturn(t||document,n,r)}function ajaxStart(e){e.global&&$.active++===0&&triggerGlobal(e,null,"ajaxStart")}function ajaxStop(e){e.global&&!--$.active&&triggerGlobal(e,null,"ajaxStop")}function ajaxBeforeSend(e,t){var n=t.context;if(t.beforeSend.call(n,e,t)===!1||triggerGlobal(t,n,"ajaxBeforeSend",[e,t])===!1)return!1;triggerGlobal(t,n,"ajaxSend",[e,t])}function ajaxSuccess(e,t,n){var r=n.context,i="success";n.success.call(r,e,i,t),triggerGlobal(n,r,"ajaxSuccess",[t,n,e]),ajaxComplete(i,t,n)}function ajaxError(e,t,n,r){var i=r.context;r.error.call(i,n,t,e),triggerGlobal(r,i,"ajaxError",[n,r,e]),ajaxComplete(t,n,r)}function ajaxComplete(e,t,n){var r=n.context;n.complete.call(r,t,e),triggerGlobal(n,r,"ajaxComplete",[t,n]),ajaxStop(n)}function empty(){}function mimeToDataType(e){return e&&(e==htmlType?"html":e==jsonType?"json":scriptTypeRE.test(e)?"script":xmlTypeRE.test(e)&&"xml")||"text"}function appendQuery(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function serializeData(e){isObject(e.data)&&(e.data=$.param(e.data)),e.data&&(!e.type||e.type.toUpperCase()=="GET")&&(e.url=appendQuery(e.url,e.data))}function serialize(e,t,n,r){var i=$.isArray(t);$.each(t,function(t,s){r&&(t=n?r:r+"["+(i?"":t)+"]"),!r&&i?e.add(s.name,s.value):(n?$.isArray(s):isObject(s))?serialize(e,s,n,t):e.add(t,s)})}var jsonpID=0,isObject=$.isObject,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(e){var t="jsonp"+ ++jsonpID,n=document.createElement("script"),r=function(){$(n).remove(),t in window&&(window[t]=empty),ajaxComplete("abort",i,e)},i={abort:r},s;return e.error&&(n.onerror=function(){i.abort(),e.error()}),window[t]=function(r){clearTimeout(s),$(n).remove(),delete window[t],ajaxSuccess(r,i,e)},serializeData(e),n.src=e.url.replace(/=\?/,"="+t),$("head").append(n),e.timeout>0&&(s=setTimeout(function(){i.abort(),ajaxComplete("timeout",i,e)},e.timeout)),i},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host);var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);settings.url||(settings.url=window.location.toString()),serializeData(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=$.ajaxSettings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.contentType||settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:JSON.parse(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,"error",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(e,t){return $.ajax({url:e,success:t})},$.post=function(e,t,n,r){return $.isFunction(t)&&(r=r||n,n=t,t=null),$.ajax({type:"POST",url:e,data:t,success:n,dataType:r})},$.getJSON=function(e,t){return $.ajax({url:e,success:t,dataType:"json"})},$.fn.load=function(e,t){if(!this.length)return this;var n=this,r=e.split(/\s/),i;return r.length>1&&(e=r[0],i=r[1]),$.get(e,function(e){n.html(i?$(document.createElement("div")).html(e.replace(rscript,"")).find(i).html():e),t&&t.call(n)}),this};var escape=encodeURIComponent;$.param=function(e,t){var n=[];return n.add=function(e,t){this.push(escape(e)+"="+escape(t))},serialize(n,e,t),n.join("&").replace("%20","+")}}(Zepto),function(e){e.fn.serializeArray=function(){var t=[],n;return e(Array.prototype.slice.call(this.get(0).elements)).each(function(){n=e(this);var r=n.attr("type");this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&r!="submit"&&r!="reset"&&r!="button"&&(r!="radio"&&r!="checkbox"||this.checked)&&t.push({name:n.attr("name"),value:n.val()})}),t},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(e){function r(e){return"tagName"in e?e:e.parentNode}function i(e,t,n,r){var i=Math.abs(e-t),s=Math.abs(n-r);return i>=s?e-t>0?"Left":"Right":n-r>0?"Up":"Down"}function u(){o=null,t.last&&(t.el.trigger("longTap"),t={})}function a(){o&&clearTimeout(o),o=null}var t={},n,s=750,o;e(document).ready(function(){var f,l;e(document.body).bind("touchstart",function(i){f=Date.now(),l=f-(t.last||f),t.el=e(r(i.touches[0].target)),n&&clearTimeout(n),t.x1=i.touches[0].pageX,t.y1=i.touches[0].pageY,l>0&&l<=250&&(t.isDoubleTap=!0),t.last=f,o=setTimeout(u,s)}).bind("touchmove",function(e){a(),t.x2=e.touches[0].pageX,t.y2=e.touches[0].pageY}).bind("touchend",function(e){a(),t.isDoubleTap?(t.el.trigger("doubleTap"),t={}):t.x2&&Math.abs(t.x1-t.x2)>30||t.y2&&Math.abs(t.y1-t.y2)>30?(t.el.trigger("swipe")&&t.el.trigger("swipe"+i(t.x1,t.x2,t.y1,t.y2)),t={}):"last"in t&&(t.el.trigger("tap"),n=setTimeout(function(){n=null,t.el.trigger("singleTap"),t={}},250))}).bind("touchcancel",function(){n&&clearTimeout(n),o&&clearTimeout(o),o=n=null,t={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}})}(Zepto),define("zepto",function(e){return function(){var t,n;return t||e.$}}(this)),!function(e){function t(e,t){var n;if(e&&dt[typeof e])for(n in e)if(Ct.call(e,n)&&t(e[n],n,e)===et)break}function n(e,t){var n;if(e&&dt[typeof e])for(n in e)if(t(e[n],n,e)===et)break}function r(e){var t,n=[];if(!e||!dt[typeof e])return n;for(t in e)Ct.call(e,t)&&n.push(t);return n}function i(e,t,n){n=(n||0)-1;for(var r=e.length;++n<r;)if(e[n]===t)return n;return-1}function s(e,t){var n=e.m,r=t.m;if(e=e.l,t=t.l,e!==t){if(e>t||typeof e=="undefined")return 1;if(e<t||typeof t=="undefined")return-1}return n<r?-1:1}function o(e){return"\\"+vt[e]}function u(){}function a(e){return e instanceof a?e:new f(e)}function f(e){this.__wrapped__=e}function l(e,t,n){function r(){var a=arguments,f=s?this:t;return i||(e=t[o]),n.length&&(a=a.length?(a=It.call(a),u?a.concat(n):n.concat(a)):n),this instanceof r?(f=c(e.prototype),a=e.apply(f,a),x(a)?a:f):e.apply(f,a)}var i=S(e),s=!n,o=t;if(s){var u=void 0;n=t}else if(!i)throw new TypeError;return r}function c(e){return x(e)?Mt(e):{}}function h(e){return Wt[e]}function p(){var e=(e=a.indexOf)===U?i:e;return e}function d(e){return Xt[e]}function v(e){return At.call(e)==ot}function m(e){if(!e)return e;for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];if(r)for(var i in r)e[i]=r[i]}return e}function g(e){if(!e)return e;for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];if(r)for(var i in r)e[i]==G&&(e[i]=r[i])}return e}function y(e){var t=[];return n(e,function(e,n){S(e)&&t.push(n)}),t.sort()}function b(e){for(var t=-1,n=zt(e),r=n.length,i={};++t<r;){var s=n[t];i[e[s]]=s}return i}function w(e){if(!e)return Q;if(Ut(e)||N(e))return!e.length;for(var t in e)if(Ct.call(e,t))return Y;return Q}function E(e,t,r,i){if(e===t)return 0!==e||1/e==1/t;var s=typeof e,o=typeof t;if(e===e&&(!e||"function"!=s&&"object"!=s)&&(!t||"function"!=o&&"object"!=o))return Y;if(e==G||t==G)return e===t;if(o=At.call(e),s=At.call(t),o!=s)return Y;switch(o){case at:case ft:return+e==+t;case lt:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case ht:case pt:return e==t+""}if(s=o==ut,!s){if(e instanceof a||t instanceof a)return E(e.__wrapped__||e,t.__wrapped__||t,r,i);if(o!=ct)return Y;var o=e.constructor,u=t.constructor;if(o!=u&&(!S(o)||!(o instanceof o&&S(u)&&u instanceof u)))return Y}for(r||(r=[]),i||(i=[]),o=r.length;o--;)if(r[o]==e)return i[o]==t;var f=Q,l=0;if(r.push(e),i.push(t),s){if(l=t.length,f=l==e.length)for(;l--&&(f=E(e[l],t[l],r,i)););return f}return n(t,function(t,n,s){return Ct.call(s,n)?(l++,!(f=Ct.call(e,n)&&E(e[n],t,r,i))&&et):void 0}),f&&n(e,function(e,t,n){return Ct.call(n,t)?!(f=-1<--l)&&et:void 0}),f}function S(e){return typeof e=="function"}function x(e){return!!e&&!!dt[typeof e]}function T(e){return typeof e=="number"||At.call(e)==lt}function N(e){return typeof e=="string"||At.call(e)==pt}function C(e){for(var t=-1,n=zt(e),r=n.length,i=Array(r);++t<r;)i[t]=e[n[t]];return i}function k(e,n){var r=p(),i=e?e.length:0,s=Y;return i&&typeof i=="number"?s=-1<r(e,n):t(e,function(e){return(s=e===n)&&et}),s}function L(e,n,r){var i=Q;n=$(n,r),r=-1;var s=e?e.length:0;if(typeof s=="number")for(;++r<s&&(i=!!n(e[r],r,e)););else t(e,function(e,t,r){return!(i=!!n(e,t,r))&&et});return i}function A(e,n,r){var i=[];n=$(n,r),r=-1;var s=e?e.length:0;if(typeof s=="number")for(;++r<s;){var o=e[r];n(o,r,e)&&i.push(o)}else t(e,function(e,t,r){n(e,t,r)&&i.push(e)});return i}function O(e,n,r){n=$(n,r),r=-1;var i=e?e.length:0;if(typeof i!="number"){var s;return t(e,function(e,t,r){return n(e,t,r)?(s=e,et):void 0}),s}for(;++r<i;){var o=e[r];if(n(o,r,e))return o}}function M(e,n,r){var i=-1,s=e?e.length:0;if(n=n&&typeof r=="undefined"?n:$(n,r),typeof s=="number")for(;++i<s&&n(e[i],i,e)!==et;);else t(e,n)}function _(e,n,r){var i=-1,s=e?e.length:0;if(n=$(n,r),typeof s=="number")for(var o=Array(s);++i<s;)o[i]=n(e[i],i,e);else o=[],t(e,function(e,t,r){o[++i]=n(e,t,r)});return o}function D(e,t,n){var r=-1/0,i=r,s=-1,o=e?e.length:0;if(t||typeof o!="number")t=$(t,n),M(e,function(e,n,s){n=t(e,n,s),n>r&&(r=n,i=e)});else for(;++s<o;)n=e[s],n>i&&(i=n);return i}function P(e,t){var n=-1,r=e?e.length:0;if(typeof r=="number")for(var i=Array(r);++n<r;)i[n]=e[n][t];return i||_(e,t)}function H(e,n,r,i){if(!e)return r;var s=3>arguments.length;n=$(n,i,4);var o=-1,u=e.length;if(typeof u=="number")for(s&&(r=e[++o]);++o<u;)r=n(r,e[o],o,e);else t(e,function(e,t,i){r=s?(s=Y,e):n(r,e,t,i)});return r}function B(e,t,n,r){var i=e?e.length:0,s=3>arguments.length;if(typeof i!="number")var o=zt(e),i=o.length;return t=$(t,r,4),M(e,function(r,u,a){u=o?o[--i]:--i,n=s?(s=Y,e[u]):t(n,e[u],u,a)}),n}function j(e,n,r){var i;n=$(n,r),r=-1;var s=e?e.length:0;if(typeof s=="number")for(;++r<s&&!(i=n(e[r],r,e)););else t(e,function(e,t,r){return(i=n(e,t,r))&&et});return!!i}function F(e,t,n){return n&&w(t)?G:(n?O:A)(e,t)}function I(e){for(var t=-1,n=p(),r=e.length,i=Tt.apply(bt,It.call(arguments,1)),s=[];++t<r;){var o=e[t];0>n(i,o)&&s.push(o)}return s}function q(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=G){var s=-1;for(t=$(t,n);++s<i&&t(e[s],s,e);)r++}else if(r=t,r==G||n)return e[0];return It.call(e,0,jt(Bt(0,r),i))}}function R(e,t){for(var n=-1,r=e?e.length:0,i=[];++n<r;){var s=e[n];Ut(s)?kt.apply(i,t?s:R(s)):i.push(s)}return i}function U(e,t,n){if(typeof n=="number"){var r=e?e.length:0;n=0>n?Bt(0,r+n):n||0}else if(n)return n=W(e,t),e[n]===t?n:-1;return e?i(e,t,n):-1}function z(e,t,n){if(typeof t!="number"&&t!=G){var r=0,i=-1,s=e?e.length:0;for(t=$(t,n);++i<s&&t(e[i],i,e);)r++}else r=t==G||n?1:Bt(0,t);return It.call(e,r)}function W(e,t,n,r){var i=0,s=e?e.length:i;for(n=n?$(n,r,1):J,t=n(t);i<s;)r=i+s>>>1,n(e[r])<t?i=r+1:s=r;return i}function X(e,t,n,r){var i=-1,s=p(),o=e?e.length:0,u=[],a=u;for(typeof t!="boolean"&&t!=G&&(r=n,n=t,t=Y),n!=G&&(a=[],n=$(n,r));++i<o;){r=e[i];var f=n?n(r,i,e):r;(t?!i||a[a.length-1]!==f:0>s(a,f))&&(n&&a.push(f),u.push(r))}return u}function V(e,t){return Rt.fastBind||Ot&&2<arguments.length?Ot.call.apply(Ot,arguments):l(e,t,It.call(arguments,2))}function $(e,t,n){if(e==G)return J;var r=typeof e;if("function"!=r){if("object"!=r)return function(t){return t[e]};var i=zt(e);return function(t){for(var n=i.length,r=Y;n--&&(r=t[i[n]]===e[i[n]]););return r}}return typeof t=="undefined"?e:1===n?function(n){return e.call(t,n)}:2===n?function(n,r){return e.call(t,n,r)}:4===n?function(n,r,i,s){return e.call(t,n,r,i,s)}:function(n,r,i){return e.call(t,n,r,i)}}function J(e){return e}function K(e){M(y(e),function(t){var n=a[t]=e[t];a.prototype[t]=function(){var e=[this.__wrapped__];return kt.apply(e,arguments),e=n.apply(a,e),this.__chain__&&(e=new f(e),e.__chain__=Q),e}})}var Q=!0,G=null,Y=!1,Z=0,et={},tt=+(new Date)+"",nt=/&(?:amp|lt|gt|quot|#39);/g,rt=/($^)/,it=/[&<>"']/g,st=/['\n\r\t\u2028\u2029\\]/g,ot="[object Arguments]",ut="[object Array]",at="[object Boolean]",ft="[object Date]",lt="[object Number]",ct="[object Object]",ht="[object RegExp]",pt="[object String]",dt={"boolean":Y,"function":Q,object:Q,number:Y,string:Y,"undefined":Y},vt={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},mt=dt[typeof exports]&&exports,gt=dt[typeof module]&&module&&module.exports==mt&&module,yt=dt[typeof global]&&global;!yt||yt.global!==yt&&yt.window!==yt||(e=yt);var bt=[],yt=Object.prototype,wt=e._,Et=RegExp("^"+(yt.valueOf+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),St=Math.ceil,xt=e.clearTimeout,Tt=bt.concat,Nt=Math.floor,Ct=yt.hasOwnProperty,kt=bt.push,Lt=e.setTimeout,At=yt.toString,Ot=Et.test(Ot=At.bind)&&Ot,Mt=Et.test(Mt=Object.create)&&Mt,_t=Et.test(_t=Array.isArray)&&_t,Dt=e.isFinite,Pt=e.isNaN,Ht=Et.test(Ht=Object.keys)&&Ht,Bt=Math.max,jt=Math.min,Ft=Math.random,It=bt.slice,yt=Et.test(e.attachEvent),qt=Ot&&!/\n|true/.test(Ot+yt);f.prototype=a.prototype;var Rt={};!function(){var e={0:1,length:1};Rt.fastBind=Ot&&!qt,Rt.spliceObjects=(bt.splice.call(e,0,1),!e[0])}(1),a.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""},Mt||(c=function(e){if(x(e)){u.prototype=e;var t=new u;u.prototype=G}return t||{}}),v(arguments)||(v=function(e){return e?Ct.call(e,"callee"):Y});var Ut=_t||function(e){return e?typeof e=="object"&&At.call(e)==ut:Y},zt=Ht?function(e){return x(e)?Ht(e):[]}:r,Wt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xt=b(Wt);S(/x/)&&(S=function(e){return typeof e=="function"&&"[object Function]"==At.call(e)}),a.after=function(e,t){return 1>e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},a.bind=V,a.bindAll=function(e){for(var t=1<arguments.length?Tt.apply(bt,It.call(arguments,1)):y(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=V(e[i],e)}return e},a.compact=function(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r},a.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},a.countBy=function(e,t,n){var r={};return t=$(t,n),M(e,function(e,n,i){n=t(e,n,i)+"",Ct.call(r,n)?r[n]++:r[n]=1}),r},a.debounce=function(e,t,n){function r(){u=G,n||(s=e.apply(o,i))}var i,s,o,u=G;return function(){var a=n&&!u;return i=arguments,o=this,xt(u),u=Lt(r,t),a&&(s=e.apply(o,i)),s}},a.defaults=g,a.defer=function(e){var t=It.call(arguments,1);return Lt(function(){e.apply(void 0,t)},1)},a.delay=function(e,t){var n=It.call(arguments,2);return Lt(function(){e.apply(void 0,n)},t)},a.difference=I,a.filter=A,a.flatten=R,a.forEach=M,a.functions=y,a.groupBy=function(e,t,n){var r={};return t=$(t,n),M(e,function(e,n,i){n=t(e,n,i)+"",(Ct.call(r,n)?r[n]:r[n]=[]).push(e)}),r},a.initial=function(e,t,n){if(!e)return[];var r=0,i=e.length;if(typeof t!="number"&&t!=G){var s=i;for(t=$(t,n);s--&&t(e[s],s,e);)r++}else r=t==G||n?1:t||r;return It.call(e,0,jt(Bt(0,i-r),i))},a.intersection=function(e){var t=arguments,n=t.length,r=-1,i=p(),s=e?e.length:0,o=[];e:for(;++r<s;){var u=e[r];if(0>i(o,u)){for(var a=n;--a;)if(0>i(t[a],u))continue e;o.push(u)}}return o},a.invert=b,a.invoke=function(e,t){var n=It.call(arguments,2),r=-1,i=typeof t=="function",s=e?e.length:0,o=Array(typeof s=="number"?s:0);return M(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o},a.keys=zt,a.map=_,a.max=D,a.memoize=function(e,t){var n={};return function(){var r=tt+(t?t.apply(this,arguments):arguments[0]);return Ct.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}},a.min=function(e,t,n){var r=1/0,i=r,s=-1,o=e?e.length:0;if(t||typeof o!="number")t=$(t,n),M(e,function(e,n,s){n=t(e,n,s),n<r&&(r=n,i=e)});else for(;++s<o;)n=e[s],n<i&&(i=n);return i},a.omit=function(e){var t=p(),r=Tt.apply(bt,It.call(arguments,1)),i={};return n(e,function(e,n){0>t(r,n)&&(i[n]=e)}),i},a.once=function(e){var t,n;return function(){return t?n:(t=Q,n=e.apply(this,arguments),e=G,n)}},a.pairs=function(e){for(var t=-1,n=zt(e),r=n.length,i=Array(r);++t<r;){var s=n[t];i[t]=[s,e[s]]}return i},a.partial=function(e){return l(e,It.call(arguments,1))},a.pick=function(e){for(var t=-1,n=Tt.apply(bt,It.call(arguments,1)),r=n.length,i={};++t<r;){var s=n[t];s in e&&(i[s]=e[s])}return i},a.pluck=P,a.range=function(e,t,n){e=+e||0,n=+n||1,t==G&&(t=e,e=0);var r=-1;t=Bt(0,St((t-e)/n));for(var i=Array(t);++r<t;)i[r]=e,e+=n;return i},a.reject=function(e,t,n){return t=$(t,n),A(e,function(e,n,r){return!t(e,n,r)})},a.rest=z,a.shuffle=function(e){var t=-1,n=e?e.length:0,r=Array(typeof n=="number"?n:0);return M(e,function(e){var n=Nt(Ft()*(++t+1));r[t]=r[n],r[n]=e}),r},a.sortBy=function(e,t,n){var r=-1,i=e?e.length:0,o=Array(typeof i=="number"?i:0);for(t=$(t,n),M(e,function(e,n,i){o[++r]={l:t(e,n,i),m:r,n:e}}),i=o.length,o.sort(s);i--;)o[i]=o[i].n;return o},a.tap=function(e,t){return t(e),e},a.throttle=function(e,t){function n(){o=new Date,u=G,i=e.apply(s,r)}var r,i,s,o=0,u=G;return function(){var a=new Date,f=t-(a-o);return r=arguments,s=this,0<f?u||(u=Lt(n,f)):(xt(u),u=G,o=a,i=e.apply(s,r)),i}},a.times=function(e,t,n){for(var r=-1,i=Array(-1<e?e:0);++r<e;)i[r]=t.call(n,r);return i},a.toArray=function(e){return Ut(e)?It.call(e):e&&typeof e.length=="number"?_(e):C(e)},a.union=function(e){return Ut(e)||(arguments[0]=e?It.call(e):bt),X(Tt.apply(bt,arguments))},a.uniq=X,a.values=C,a.where=F,a.without=function(e){return I(e,It.call(arguments,1))},a.wrap=function(e,t){return function(){var n=[e];return kt.apply(n,arguments),t.apply(this,n)}},a.zip=function(e){for(var t=-1,n=e?D(P(arguments,"length")):0,r=Array(0>n?0:n);++t<n;)r[t]=P(arguments,t);return r},a.collect=_,a.drop=z,a.each=M,a.extend=m,a.methods=y,a.object=function(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var s=e[n];t?i[s]=t[n]:i[s[0]]=s[1]}return i},a.select=A,a.tail=z,a.unique=X,a.chain=function(e){return e=new f(e),e.__chain__=Q,e},a.clone=function(e){return x(e)?Ut(e)?It.call(e):m({},e):e},a.contains=k,a.escape=function(e){return e==G?"":(e+"").replace(it,h)},a.every=L,a.find=O,a.has=function(e,t){return e?Ct.call(e,t):Y},a.identity=J,a.indexOf=U,a.isArguments=v,a.isArray=Ut,a.isBoolean=function(e){return e===Q||e===Y||At.call(e)==at},a.isDate=function(e){return e?typeof e=="object"&&At.call(e)==ft:Y},a.isElement=function(e){return e?1===e.nodeType:Y},a.isEmpty=w,a.isEqual=E,a.isFinite=function(e){return Dt(e)&&!Pt(parseFloat(e))},a.isFunction=S,a.isNaN=function(e){return T(e)&&e!=+e},a.isNull=function(e){return e===G},a.isNumber=T,a.isObject=x,a.isRegExp=function(e){return!!e&&!!dt[typeof e]&&At.call(e)==ht},a.isString=N,a.isUndefined=function(e){return typeof e=="undefined"},a.lastIndexOf=function(e,t,n){var r=e?e.length:0;for(typeof n=="number"&&(r=(0>n?Bt(0,r+n):jt(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},a.mixin=K,a.noConflict=function(){return e._=wt,this},a.random=function(e,t){e==G&&t==G&&(t=1),e=+e||0,t==G?(t=e,e=0):t=+t||0;var n=Ft();return e%1||t%1?e+jt(n*(t-e+parseFloat("1e-"+((n+"").length-1))),t):e+Nt(n*(t-e+1))},a.reduce=H,a.reduceRight=B,a.result=function(e,t){var n=e?e[t]:G;return S(n)?e[t]():n},a.size=function(e){var t=e?e.length:0;return typeof t=="number"?t:zt(e).length},a.some=j,a.sortedIndex=W,a.template=function(e,t,n){var r=a.templateSettings;e||(e=""),n=g({},n,r);var i=0,s="__p+='",r=n.variable;e.replace(RegExp((n.escape||rt).source+"|"+(n.interpolate||rt).source+"|"+(n.evaluate||rt).source+"|$","g"),function(t,n,r,u,a){return s+=e.slice(i,a).replace(st,o),n&&(s+="'+_['escape']("+n+")+'"),u&&(s+="';"+u+";__p+='"),r&&(s+="'+((__t=("+r+"))==null?'':__t)+'"),i=a+t.length,t}),s+="';\n",r||(r="obj",s="with("+r+"||{}){"+s+"}"),s="function("+r+"){var __t,__p='',__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}"+s+"return __p}";try{var u=Function("_","return "+s)(a)}catch(f){throw f.source=s,f}return t?u(t):(u.source=s,u)},a.unescape=function(e){return e==G?"":(e+"").replace(nt,d)},a.uniqueId=function(e){var t=++Z+"";return e?e+t:t},a.all=L,a.any=j,a.detect=O,a.findWhere=function(e,t){return F(e,t,Q)},a.foldl=H,a.foldr=B,a.include=k,a.inject=H,a.first=q,a.last=function(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=G){var s=i;for(t=$(t,n);s--&&t(e[s],s,e);)r++}else if(r=t,r==G||n)return e[i-1];return It.call(e,Bt(0,i-r))}},a.take=q,a.head=q,a.VERSION="1.3.1",K(a),a.prototype.chain=function(){return this.__chain__=Q,this},a.prototype.value=function(){return this.__wrapped__},M("pop push reverse shift sort splice unshift".split(" "),function(e){var t=bt[e];a.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),!Rt.spliceObjects&&0===e.length&&delete e[0],this}}),M(["concat","join","slice"],function(e){var t=bt[e];a.prototype[e]=function(){var e=t.apply(this.__wrapped__,arguments);return this.__chain__&&(e=new f(e),e.__chain__=Q),e}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(e._=a,define("underscore",[],function(){return a})):mt&&!mt.nodeType?gt?(gt.exports=a)._=a:mt._=a:e._=a}(this),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore","zepto"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),require(["underscore"],function(e){window.drawer=null,window.scoreTable=null,window.twoPI=Math.PI*2,window.onPointerDown=null,window.inherits=function(t,n){return e.defaults(t.prototype,n.prototype),t},window.spinnerCenter={x:0,y:0}}),define("globals.js",function(){}),define("spinner",["underscore"],function(e){var t=function(t){this.rotation=0,e.extend(this,t)};return t.prototype={rotateBy:function(e){this.rotation=(this.rotation+e)%(Math.PI*2)},draw:function(e,t){var n=this.rotation;e.beginPath();while(n<this.rotation+Math.PI*2)e.arc(t.x,t.y,this.radius,n,n+this.arc,!1),n+=this.arc*2,e.moveTo(t.x+this.radius*Math.cos(n),t.y+this.radius*Math.sin(n));e.stroke()},includes:function(e){return(e+Math.PI*2-this.rotation)%(this.arc*2)<=this.arc}},t}),define("rivetTimer",["globals.js"],function(){function e(e){this.progress=0,this.timeout=e,this.paused=!0}return e.prototype={bulbRadius:10,graphicalLength:400,pickColor:function(e){this.progress<.7?e.fillStyle="green":.7<this.progress&&this.progress<.9?e.fillStyle="yellow":e.fillStyle="red"},draw:function(e,t){var n={x:t.x-this.bulbRadius,y:t.y},r={x:n.x+this.graphicalLength,y:n.y},i=this.bulbRadius,s=i*2,o=this.progress*this.graphicalLength,u=null,a=null,f=2*Math.PI;e.strokeStyle="white",e.beginPath(),e.moveTo(n.x,r.y),e.lineTo(r.x,r.y),e.stroke(),e.strokeStyle="black",this.pickColor(e),0<o&&o<s?(a=o-i,u=Math.acos(a/i),e.beginPath(),this.pickColor(e),e.moveTo(n.x+o,n.y),e.arc(n.x+i,n.y,i-e.lineWidth,u,-u,!1),e.fill()):s<o&&o<=this.graphicalLength&&(this.pickColor(e),e.strokeStyle=e.fillStyle,e.beginPath(),e.moveTo(n.x+s,n.y),e.arc(n.x+i,n.y,i-e.lineWidth,0,f,!1),e.fill(),e.beginPath(),e.moveTo(n.x+i,n.y),e.lineTo(n.x+o,n.y),e.stroke(),a=o-(this.graphicalLength-i),Math.abs(a)<=i&&(u=Math.acos(a/i),e.beginPath(),e.moveTo(n.x+o,r.y),e.arc(r.x-i,r.y,i-e.lineWidth,f-u,u,!0),e.fill())),e.fillStyle="black",e.strokeStyle="black",e.beginPath(),e.moveTo(n.x+s,n.y),e.arc(n.x+i,n.y,i,0,f,!1),e.moveTo(n.x+s,n.y-e.lineWidth),e.lineTo(r.x-s,r.y-e.lineWidth),e.moveTo(n.x+s,n.y+e.lineWidth),e.lineTo(r.x-s,r.y+e.lineWidth),e.moveTo(r.x,r.y),e.arc(r.x-i,r.y,i,0,f,!1),e.stroke()},bump:function(e){return this.paused?!1:(this.progress+=e/this.timeout,this.progress>1?(this.progress=1,!0):!1)},reset:function(){this.progress=0},setTimeout:function(e){this.timeout=e,this.reset()}},e}),define("gameView",["underscore","globals.js","spinner","rivetTimer"],function(e,t,n,r){var i=function(e,t){this.fgCtx=e,this.bgCtx=t,this.eraseBackground=[],this.drawBackground=[],this.drawForeground=[]};return i.prototype={reset:function(){this.eraseBackground=[],this.drawBackground=[],this.drawForeground=[]},setRivetTimer:function(e){this.rivetTimer=e},addActiveSpinner:function(e){this.drawForeground.push(e)},addInactiveSpinner:function(e){this.drawBackground.push(e)},removeInactiveSpinner:function(t){this.eraseBackground.push(e.chain(t).clone().extend({arc:Math.PI*2,rotation:0}).value())},clearInactiveSpinners:function(e){this.drawBackground=[]},clearCanvases:function(){this.fgCtx.clearRect(0,0,this.fgCtx.canvas.width,this.fgCtx.canvas.height),this.bgCtx.clearRect(0,0,this.bgCtx.canvas.width,this.bgCtx.canvas.height)},update:function(){this.drawGraphics({style:this.styles.eraseSpinner,ctx:this.bgCtx,drawables:this.eraseBackground}),this.eraseBackground=[],this.drawGraphics({style:this.styles.inactiveSpinners,ctx:this.bgCtx,drawables:this.drawBackground}),this.fgCtx.clearRect(0,0,this.fgCtx.canvas.width,this.fgCtx.canvas.height),this.drawGraphics({style:this.styles.activeSpinners,ctx:this.fgCtx,drawables:this.drawForeground}),this.drawGraphics({style:this.styles.rivetTimer,ctx:this.fgCtx,drawables:[this.rivetTimer]})},drawGraphics:function(t){if(t.drawables.length===0)return;e.extend(t.ctx,t.style),e.each(t.drawables,function(e){e.draw(t.ctx,spinnerCenter)})},styles:{rivetTimer:{lineWidth:2,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,globalCompositeOperation:"source-over"},inactiveSpinners:{lineWidth:2,strokeStyle:"#EFEFEF",shadowColor:"black",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:2,globalCompositeOperation:"source-over"},activeSpinners:{lineWidth:2,strokeStyle:"red",shadowColor:"",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,globalCompositeOperation:"source-over"},eraseSpinner:{lineWidth:8,strokeStyle:"#FFFFFF",shadowColor:"#FFFFFF",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:2,globalCompositeOperation:"destination-out"}}},i}),define("score",["backbone"],function(e){return e.Model.extend({defaults:{ringsCleared:0,timeBonus:0},total:function(){return this.get("ringsCleared")*30+this.get("timeBonus")}})}),define("modes",["underscore","globals.js","score","spinner","rivetTimer"],function(e,t,n,r,i){function o(){}function u(e){this.game=e,this.view=e.gameView}function a(e){this.game=e,this.view=e.gameView}function f(e){this.game=e,this.view=e.gameView}function l(e){this.game=e,this.view=e.gameView}var s={difficulty:{easy:0,medium:1,hard:2,infinite:3,toString:function(e){return["easy","medium","hard","infinite"][e]}}};return o.prototype={score:null,spinners:null,update:function(e){var t=this.spinners[this.active];t.rotateBy(t.arc*3*e/1e3),this.timer.bump(e)&&(this.game.userLost("You ran out of time!"),this.onFailure()),this.updateScore()},updateScore:function(){var e=0;this.game.state()!==this.game.states.lost&&(e=Math.round((1-this.timer.progress)*400)),this.score.set({ringsCleared:this.active,timeBonus:e})},draw:function(){this.view.update(),this.view.clearInactiveSpinners()},drawOnce:function(){e.chain(this.spinners).rest().each(function(e){this.view.addInactiveSpinner(e)},this),this.view.addActiveSpinner(this.spinners[0]),this.view.update()},onCanvasAction:function(){var e=this.spinners[this.active];if(this.spinners[this.active].includes(.01)||this.spinners[this.active].includes(-0.01)){this.game.userLost("You hit the timer bar!"),this.onFailure();return}this.onNoCollision(),this.timer.paused=!1},onFailure:function(){this.updateScore()},onNoCollision:function(){this.active+=1,this.updateScore(),this.active>=this.spinners.length?this.game.userWon():(this.view.reset(),this.view.addInactiveSpinner(this.spinners[this.active-1]),this.view.removeInactiveSpinner(this.spinners[this.active]),this.view.addActiveSpinner(this.spinners[this.active]))},init:function(){this.active=0,this.timer=new i(15e3),this.view.setRivetTimer(this.timer),this.score===null?this.score=new n:this.score.set({timeBonus:0,ringsCleared:0}),this.updateScore(),this.spinners=[],this.buildSpinners(),this.view.reset(),this.view.clearCanvases()},buildCommonSpinners:function(t,n,i){var s,o,u,a,f;s=20,e.times(n,function(e){u=Math.ceil(s/t*Math.random()),u===0&&(u+=1),a=Math.PI/u,this.spinners.push(new r({radius:s,arc:a,rotation:Math.random()*Math.PI*2})),s+=20},this),this.timer.graphicalLength=s+5+this.timer.bulbRadius},active:0,time:null},u.prototype={buildSpinners:function(){this.buildCommonSpinners(10,10,.7)},getModeString:function(){return"Easy"}},a.prototype={buildSpinners:function(){this.buildCommonSpinners(5,15,1)},getModeString:function(){return"Medium"}},f.prototype={buildSpinners:function(){this.buildCommonSpinners(4,20,1.3)},getModeString:function(){return"Hard"}},l.prototype={init:function(){o.prototype.init.call(this),this.timer.setTimeout(2e3),this.buildInfiniteSpinner()},onFailure:function(){},updateScore:function(){},onNoCollision:function(){this.score.set({timeBonus:this.score.get("timeBonus")+Math.round((1-this.timer.progress)*5),ringsCleared:this.score.get("ringsCleared")+1}),this.buildInfiniteSpinner(),this.view.reset(),this.view.addActiveSpinner(this.spinners[0]),this.timer.reset()},getModeString:function(){return"Infinite"},buildSpinners:function(){this.buildInfiniteSpinner()},buildInfiniteSpinner:function(){var e=Math.random()*330+20,t=Math.ceil(e/4*Math.random()),n=new r({radius:e,arc:Math.PI/t,rotation:Math.random()*Math.PI*2});this.spinners[0]=n,this.timer.graphicalLength=355+this.timer.bulbRadius*3}},inherits(u,o),inherits(a,o),inherits(f,o),inherits(l,o),s.EasyMode=u,s.MediumMode=a,s.HardMode=f,s.InfiniteMode=l,s}),define("timer",["underscore"],function(e){var t,n,r;return t=function(){this.requestAnimationFrame=window.requestAnimationFrame,this.cancelAnimationFrame=window.cancelAnimationFrame,e(["ms","moz","webkit","o"]).each(function(e){this.requestAnimationFrame=this.requestAnimationFrame||window[e+"RequestAnimationFrame"],this.cancelAnimationFrame=this.cancelAnimationFrame||window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"]},this),this.requestAnimationFrame&&(this.requestAnimationFrame=e.bind(this.requestAnimationFrame,window),this.cancelAnimationFrame=e.bind(this.cancelAnimationFrame,window))},n=function(e){this._functions=e,this.update=null,this.scope=null,this._requestID=null,this._lastCalled=null},n.prototype={run:function(){var e=this;this._lastCalled===null&&(this._lastCalled=new Date),this._requestID=this._functions.requestAnimationFrame(function(){var t=new Date;e.update.call(e.scope||window,t-e._lastCalled),e._lastCalled=t})},clear:function(){this.requestID&&this._functions.cancelAnimationFrame(this._requestID)}},r=function(e){this.update=null,this.scope=null,this.timeout=e,this._timeoutID=null,this._lastCalled=null},r.prototype={run:function(){var e=this;this._lastCalled===null&&(this._lastCalled=new Date),this._requestID=window.setTimeout(function(){var t=new Date;e.update.call(e.scope||window,t-e._lastCalled),e._lastCalled=t},this.timeout)},clear:function(){this._timeoutID&&(window.clearTimeout(this._timeoutID),this._timeoutID=null)}},function(e){var i=new t;return i.requestAnimationFrame&&i.cancelAnimationFrame?new n(i):new r(e)}}),define("ScoreTable",["backbone","underscore","modes","score"],function(e,t,n,r){return e.Model.extend({defaults:{easy:0,medium:0,hard:0,infinite:0},considerScore:function(e,t){var n=e.total(),r=this.get(t),i={};n>r&&(i[t]=n,this.set(i),this.writeScores())},loadScores:function(){var e=JSON.parse(localStorage.getItem("highScores")),n;e===null&&(e={}),n=t.defaults(t.pick(e,"easy","medium","hard","infinite"),{easy:e.Easy,medium:e.Medium,hard:e.Hard,infinite:e.Infinite}),t.each(n,function(e,i){if(t.isNumber(e))return;if(t.isObject(e)&&t.has(e,"timeBonus")&&t.has(e,"ringsCleared")){n[i]=(new r({timeBonus:e.timeBonus,ringsCleared:e.ringsCleared})).total();return}n[i]=0}),this.set(n)},writeScores:function(){localStorage.setItem("highScores",JSON.stringify(this))}})}),define("game",["zepto","underscore","backbone","gameView","modes","timer","ScoreTable"],function(e,t,n,r,i,s,o){var u=n.Model.extend({defaults:{state:null,mode:null},states:{running:0,paused:1,won:2,lost:3},initialize:function(){this.timer=new s(50),this.gameView=new r(e("#canvas-fg")[0].getContext("2d"),e("#canvas-bg")[0].getContext("2d"))},state:function(){return this.get("state")},userLost:function(e){this.endGame(e,this.states.lost)},userWon:function(){this.endGame("You did it!",this.states.won)},endGame:function(e,t){var n=this.get("mode");this.set({state:t}),n.updateScore(),drawer.updateGameOverTab(scoreTable.get(n.getModeString().toLowerCase()),n.score,e),scoreTable.considerScore(n.score,n.getModeString().toLowerCase())},newMode:function(e){this.timer.scope=this,this.timer.update=function(e){var t=this.get("mode");this.state()===this.states.running&&(t.update(e),t.draw(),this.state()===this.states.running&&this.timer.run())},e.init(),e.drawOnce(),this.set({mode:e,state:this.states.running}),this.timer.run()},newGame:function(){this.timer.clear(),this.gameView.clearCanvases(),this.set({mode:null})},tryAgain:function(){var e=this.get("mode");e.init(),e.drawOnce(),this.set({state:this.states.running}),this.timer.run()},pauseGame:function(){this.state()===this.states.paused?(this.set({state:this.states.running}),this.timer.run()):this.state()===this.states.running&&(this.set({state:this.states.paused}),this.timer.clear())},makeOnBackgroundCallback:function(){t.bind(function(){this.has("mode")&&this.state()===this.states.running&&this.pauseGame()},this)},setupEvents:function(){window.onblur=this.makeOnBackgroundCallback(),window.onorientationchange=this.adjustCanvasTransformForOrientation,window.blackberry&&blackberry.app.event.onBackground(t.bind(function(){this.state()===this.states.running&&this.pauseGame()},this))},adjustCanvasTransformForOrientation:function(){var t=window.orientation;switch(t){case 0:case 180:e("canvas").css({"-webkit-transform":"translate(0px, 0px)"});break;case-90:case 90:e("canvas").css({"-webkit-transform":"translate(-80px, 80px)"})}}});return new u}),define("drawer",["zepto","underscore","modes"],function(e,t,n){var r=function(r){var i=["click","touchstart"],s=function(n,r){t(i).each(function(t){e(n).on(t,r)})};this.mainDrawer=e("#mainDrawer"),this.scoreDrawer=e("#scoreDrawer"),this.spinnerScore=e("#spinner-score")[0],this.timeBonus=e("#time-bonus")[0],this.gameOver=!1,s("#newGame-classic-easy",function(e){e.preventDefault(),r.newMode(new n.EasyMode(r))}),s("#newGame-classic-medium",function(e){e.preventDefault(),r.newMode(new n.MediumMode(r))}),s("#newGame-classic-hard",function(e){e.preventDefault(),r.newMode(new n.HardMode(r))}),s("#newGame-classic-infinite",function(e){e.preventDefault(),r.newMode(new n.InfiniteMode(r))}),s("#pauseButton",function(e){e.preventDefault(),r.pauseGame()}),s("#unpauseButton",function(e){e.preventDefault(),r.pauseGame()}),s("#gameOverTab-tryAgain",function(e){e.preventDefault(),r.tryAgain()}),window.blackberry&&blackberry.app.event.onSwipeDown(t.bind(function(){r.state()===r.states.running?r.pauseGame():this.toggle()},this)),e("#mainDrawer nav li").each(t.bind(function(n,r){var i=e(r).attr("data-tab");s(r,t.bind(function(e){e.preventDefault(),this.showTab(i)},this))},this)),r.on("change:mode",function(e,t){this.setToMode(t)},this),r.on("change:state",function(t,n){if(n===t.states.running)this.hide(),e("#pauseButton").text("pause").css({visibility:"visible"});else if(n===t.states.paused)this.showTab("pausedTab"),e("#pauseButton").text("unpause").css({visibility:"visible"}),this.show();else if(n===t.states.won||n===t.states.lost)this.gameOver=!0,this.showTab("gameOverTab"),e("#pauseButton").css({visibility:"hidden"}),n===t.states.won?e("#gameOverTab .message").text("You did it!"):e("#gameOverTab .message").text("You hit the timer!"),this.show();n!==t.states.paused&&this.hideTab("pausedTab"),n!==t.states.won&&n!==t.states.lost&&(this.hideTab("gameOverTab"),this.gameOver=!1)},this)};return r.prototype={listenToScoreTable:function(t){t.on("change:easy",function(t,n){e("#scoretable_easy").text(n)}),t.on("change:medium",function(t,n){e("#scoretable_medium").text(n)}),t.on("change:hard",function(t,n){e("#scoretable_hard").text(n)}),t.on("change:infinite",function(t,n){e("#scoretable_infinite").text(n)})},listenToScore:function(t){t.on("change",function(t){e(this.spinnerScore).html(t.get("ringsCleared")),e(this.timeBonus).html(t.get("timeBonus"))},this)},updateGameOverTab:function(t,n,r){if(!this.gameOver)return;e("#gameOverTab-totalScore").html(n.total()),e("#gameOverTab .message").html(r),e("#gameOverTab-highScore").html(t),n.total()<t?e("#gameOverTab-comparator").text("<"):n.total()>t?e("#gameOverTab-comparator").text(">"):e("#gameOverTab-comparator").text("=")},setToMode:function(t){if(t!==null){var n=t.getModeString();e("#scoreDrawer-mode").html(n),this.scoreHidden=!1,this.updateTransforms(),this.listenToScore(t.score),e(this.spinnerScore).html("0"),e(this.timeBonus).html("  ")}else this.scoreHidden=!0,this.disablePauseButton(),this.updateTransforms()},updateTransforms:function(){var e=-this.mainDrawer[0].clientHeight,n=t(["-webkit-","-o-","-moz-","-ms-",""]);this.hidden||(e=0),n.each(function(t){this.mainDrawer.css(t+"transform","translateY("+e+"px)")},this),this.scoreHidden&&(e-=this.scoreDrawer[0].clientHeight),n.each(function(t){this.scoreDrawer.css(t+"transform","translateY("+e+"px)")},this)},toggle:function(){this.hidden=!this.hidden,this.updateTransforms()},showTab:function(t){e("#mainDrawer .tab").hide(),e("#mainDrawer nav li").removeAttr("selected"),e('#mainDrawer nav li[data-tab="'+t+'"]').attr("selected",!0).css({display:"block"}),e("#"+t).show()},hideTab:function(t){e('#mainDrawer nav li[data-tab="'+t+'"]').attr("selected",!1).hide()},show:function(){this.hidden&&this.toggle()},hide:function(){this.hidden||this.toggle()},hidden:!1,scoreHidden:!0},r}),require.config({shim:{underscore:{exports:"_"},zepto:{exports:"$"},backbone:{deps:["underscore","zepto"],exports:"Backbone"}}}),require(["zepto","underscore","backbone","globals.js","game","rivetTimer","modes","drawer","ScoreTable"],function(e,t,n,r,i,s,o,u,a){o.game=i,drawer=new u(i),scoreTable=new a,drawer.listenToScoreTable(scoreTable),scoreTable.loadScores(),i.adjustCanvasTransformForOrientation(),e("#clickableArea").on("mousedown",function(e){e.preventDefault(),i.timer.clear(),i.has("mode")&&i.state()===i.states.running&&(i.get("mode").onCanvasAction(),i.timer.run())}),spinnerCenter.y=400,spinnerCenter.x=250,i.setupEvents()}),define("main",function(){});
!function(a,b){var c=a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame||a.oRequestAnimationFrame;a.animLoop=function(a,d){function e(h){if(f!==!1){c?c(e,d):setTimeout(e,16),h=h&&h>1e4?h:+new b;var i=h-g;160>i&&(f=a(i,h)),g=h}}var f,g=+new b;e()}}(window,Date);var middle=150,light_blue="#40FFE0",grey="#999285",yellowy="#F7B019",orange="#FF6E00",green="#14C77A";_={nil:function(){},$:function(a){return document.getElementById(a)},$$:function(a){return document.getElementsByTagName(a)},extend:function(a,b){return Object.keys(b).forEach(function(c){a[c]=b[c]}),a},play:function(a){this.muted||a.cloneNode().play()},muted:!1};var Seq=function(a,b,c){this.title=a,this.finished=0,this.objs=b;var d=0;b.forEach(function(a){d+=a.x,a.x0=d,d+=a.w,a.seq=this},this),this.w=d,c&&_.extend(this,c)};_.extend(Seq.prototype,{tick:function(a){this.x-=a/1e3*200,this.w+this.x<0&&this.gone()},draw:function(a){this.objs.forEach(function(b){b.x=b.x0+this.x,b.draw(a)},this)},checkHit:function(a){this.remaining=0,this.objs.forEach(function(b){b.checkHit(a)===!1&&this.remaining++},this)},init:function(a){this.game=a,this.x=1e3,this.objs.forEach(function(a){a.hit=!1}),this.setup()},gone:function(){this.teardown(),this.remaining<=0?this.finished=2:this.init(this.game)},setup:_.nil,teardown:_.nil});var Ball=function(a,b){this.x=a,this.y=middle+30*b,this.hit=!1};_.extend(Ball.prototype,{w:70,hitColor:green,checkHit:function(a){var b=a.x-this.x,c=a.y-this.y,d=this.hit;return Math.sqrt(b*b+c*c)<this.w/2+5&&(this.hit=!0,d||_.play(this.noise)),this.hit},draw:function(a){var b=this.x,c=this.y;this.hit?a.drawImage(this.img,b-this.w/2,c-this.w/2):(a.fillStyle=this.hit?this.hitColor:"white",a.beginPath(),a.moveTo(b+this.w/2,c),a.arc(b,c,this.w/2,0,2*Math.PI),a.fill())}});var BadBall=function(a,b){Ball.call(this,a,b)};BadBall.prototype=_.extend(Object.create(Ball.prototype),{w:40,hitColor:grey,checkHit:function(a){return!Ball.prototype.checkHit.call(this,a)}});var Thing=function(){this.time=0,this.x=300,this.y=middle,this.v=0};_.extend(Thing.prototype,{draw:function(a){a.fillStyle="white",a.beginPath(),a.moveTo(this.x+10,this.y),a.arc(this.x,this.y,10,0,2*Math.PI),a.fill()},tick:function(a){var b=this.y-middle,c=b>0?1:-1;this.v-=26*c/1e3*a,this.v*=1-9e-4*a,Math.abs(b)<10&&Math.abs(this.v)<10/a&&(this.v=0,this.y=middle),this.y+=this.v,Math.abs(this.y-middle)>150&&(this.y=middle+150*c,this.v=c*Math.min(8,Math.abs(this.v)))},nudge:function(a){this.v-=8*a}});var Game=function(){var a=_.$("c");this.w=a.width,this.h=a.height,this.ctx=a.getContext("2d"),this.seq=0,this.progress=_.$("progress"),this.title=_.$("title"),this.player=new Thing,this.seqs=[new Seq("tap up",[new Ball(0,0),new Ball(260,2),new Ball(90,-2.5)]),new Seq("adapt",[new BadBall(0,0),new Ball(260,2),new Ball(90,-2.5)]),new Seq("you are special and amazing",[new Ball(0,0),new BadBall(40,0),new Ball(40,0),new BadBall(40,0),new Ball(40,0),new BadBall(40,0),new Ball(40,0)]),new Seq("you don't need to know what you're doing",[new Ball(0,0),new Ball(90,3),new Ball(160,3),new Ball(30,0),new Ball(190,0)],{setup:function(){_.$$("body")[0].className="squished"},teardown:function(){_.$$("body")[0].className=""}}),new Seq("push against your limits",[new Ball(0,5),new Ball(60,5),new Ball(30,-5),new Ball(60,-5)]),new Seq("you can do it",[new Ball(0,2),new Ball(90,-2.5),new Ball(80,0),new Ball(0,0),new Ball(0,0),new Ball(0,0),new Ball(0,0),new Ball(0,0),new Ball(0,0),new Ball(0,0)]),new Seq("you can do anything",[new Ball(0,0),new Ball(30,3),new Ball(30,-0),new Ball(30,-3)]),new Seq("never give up",[new Ball(90,-2.5),new BadBall(100,5),new BadBall(-50,4),new BadBall(-50,3),new BadBall(-50,2),new BadBall(-50,1),new BadBall(-50,0),new BadBall(-50,-1),new BadBall(-50,-2),new BadBall(-50,-3),new BadBall(-50,-4),new BadBall(-50,-5),new Ball(140,2.5)],{tries:0,titles:["don't stop now","keep trying","never give up","believe in yourself"],teardown:function(){this.tries=++this.tries%this.titles.length,this.title=this.titles[this.tries],this.game.title.innerHTML=this.title}}),new Seq("how did you get here?",[new Ball(0,0)]),new Seq("srsly",[new Ball(0,0)])],this.seqs[this.seq].init(this)};_.extend(Game.prototype,{nextSeq:function(){++this.seq,this.seq>=this.seqs.length?this.finished=!0:this.seqs[this.seq].init(this),this.updatePosition()},updatePosition:function(){for(var a,b=[],c=0;c<this.seqs.length;c++)a=2==this.seqs[c].finished?"finished":"unfinished",c==this.seq&&(a="current",this.title.innerHTML=this.seqs[c].title),b.push('<span class="',a,'">&#5603;</span>');this.progress.innerHTML=b.join("")},update:function(){var a=this.seqs[this.seq];this.player.tick(1e3/60),a.tick(1e3/60),a.checkHit(this.player),this.ctx.clearRect(0,0,this.w,this.h),a.draw(this.ctx),this.player.draw(this.ctx),a.finished>0&&this.nextSeq()}}),window.onload=function(){var a=new Game;Ball.prototype.noise=_.$("h"),Ball.prototype.img=_.$("green"),BadBall.prototype.noise=_.$("l"),BadBall.prototype.img=_.$("grey"),_.$$("body")[0].onkeydown=function(b){var c=b.keyCode||b.which;38==c?a.player.nudge(1):40==c&&a.player.nudge(-1)},_.$("mute").onclick=function(){_.muted=!_.muted,_.$("mute").textContent=_.muted?"unmute":"mute"},a.updatePosition(),animLoop(function(){a.finished||a.update(1e3/60)},_.$("c"))};